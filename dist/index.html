<html>

<head>
    <script src="https://unpkg.com/vue@next/dist/vue.global.prod.js"></script>
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Oxanium:wght@200;300;400;500;600;700;800&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <title>Scoreboard</title>
</head>

<body>
    <div id="app" class="scoreboard">
        <!-- <p class="scoreboard__title">LudeCat 11</p> -->
        <table v-if="mode === 'detailed'" class="scoreboard__table scoreboard__table--ranking">
            <tr class="table__headline">
                <th></th>
                <th>Team</th>
                <th>Round</th>
                <th>|Points</th>
                <!-- <th>before</th> -->
                <!-- <th>Round 1</th>
                <th v-if="rounds > 1">Round 2</th>
                <th v-if="rounds > 2">Round 3</th> -->
            </tr>
            <tr v-for="(entry, i) in rankingSorted">
                <td class="row__rank"> {{i+1}}.</td>
                <td class="row__name">[{{entry.tag}}] {{entry.name}}</td>
                <td class="row__points-gained">{{entry.played}}</td>
                <td>{{entry.points}}</td>
                <!-- <td>{{entry.before}}</td> -->
                <!-- <td>+ {{entry.round1}}</td>
                <td v-if="rounds > 1">+ {{entry.round2}}</td>
                <td v-if="rounds > 2">+ {{entry.round3}}</td> -->
            </tr>
        </table>

        <table v-else>
            <tr>
                <th>tag</th>
                <th>name</th>
                <th>points</th>
            </tr>
            <tr v-for="entry in rankingSorted">
                <td>{{entry.tag}}</td>
                <td>{{entry.name}}</td>
                <td>{{entry.total}}</td>
            </tr>
        </table>
        <div class="scoarboard_point-distribution">
            <p class="table__header">LUDECAMP</p>
            <table class="scoreboard__table ludecamp__table">
                <tr class="table__headline">
                    <!-- <th>team</th> -->
                    <!-- <th>points</th> -->
                </tr>
                <tr v-for="entry in ludecamp">
                    <td>{{entry.name}}</td>
                </tr>
            </table>
            <p class="table__header">Next Up</p>
            <table class="scoreboard__table scoreboard__table--nextup">
                <tr class="table__headline">
                    <!-- <th>team</th> -->
                    <!-- <th>points</th> -->
                </tr>
                <tr v-for="entry in nextUp">
                    <td>{{entry.team1}}</td>
                    <td>{{entry.team2}}</td>
                    <td>{{entry.team3}}</td>
                    <td>{{entry.team4}}</td>
                </tr>
            </table>
        </div>
    </div>

    <div class="sliding-background"></div>


    <script>
        const App = {
            data() {
                return {
                    currentGame: 'N/A',
                    mode: 'detailed',
                    ranking: [
                        {
                            "name": "Team Skoda",
                            "tag": "SKODA",
                            "logo": "https://i.imgur.com/INGfsIx.jpg",
                            "points": 16,
                            "played": 4
                        },
                    ],
                    pointDistribution: [
                        {
                            "place": "1st",
                            "points": 100
                        },
                        {
                            "place": "2nd",
                            "points": 90
                        },
                        {
                            "place": "3rd",
                            "points": 80
                        },
                        {
                            "place": "...",
                            "points": "..."
                        },
                        {
                            "place": "10th",
                            "points": 10
                        }
                    ],
                    ludecamp: [{
                        "name": "GO1",
                        "logo": "https://i.imgur.com/srYZagG.png"
                    },
                    {
                        "name": "SLOTH",
                        "logo": "https://i.imgur.com/6oatVNx.png"
                    },
                    {
                        "name": "FUSER",
                        "logo": "https://i.imgur.com/dEc3KFP.png"
                    },
                    {
                        "name": "Lacka",
                        "logo": "https://i.imgur.com/OixPhRQ.png"
                    }],
                    nextUp: [{
                        "team1": "Team1",
                        "team2": "Team2",
                        "team3": "Team3",
                        "team4": "Team4"
                    },]
                }
            },
            mounted() {
                const fetchData = () => {
                    fetch('https://lc10data.herokuapp.com/scoreboard.json')
                        .then(res => res.json())
                        .then(res => {
                            // this.currentGame = res.currentGame
                            // this.mode = res.mode
                            this.ranking = res.ranking.filter(r => r.name)
                            this.ludecamp = res.ludecamp
                            this.nextUp = res.nextUp
                            // this.pointDistribution = res.pointDistribution
                            // this.rounds = res.rounds
                        })
                }
                fetchData()
                this.interval = setInterval(fetchData, 3000)
            },
            computed: {
                rankingSorted: function () {
                    return [...this.ranking].sort((a, b) => b.points - a.points)
                }
            }
        }
        const vm = Vue.createApp(App).mount('#app')
    </script>
</body>

</html>
